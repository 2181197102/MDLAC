{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
        <title>MDLAC - Air Conditioning Big Data Analysis Platform</title>
        <meta content="Air Conditioning Big Data Analysis Platform Front End" name="description" />
        <meta content="Team-MDLAC" name="author" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <link rel="shortcut icon" href="{% static 'shows/vertical/assets/images/acicon-2.png' %}">

        <!-- Table css -->
        <link href="{% static 'shows/plugins/RWD-Table-Patterns/dist/css/rwd-table.min.css' %}" rel="stylesheet" type="text/css" media="screen">

        <link href="{% static 'shows/vertical/assets/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
        <link href="{% static 'shows/vertical/assets/css/icons.css' %}" rel="stylesheet" type="text/css">
        <link href="{% static 'shows/vertical/assets/css/style.css' %}" rel="stylesheet" type="text/css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <style>
          .pagination {
            display: flex;
            justify-content: center; /* 居中对齐按钮 */
            align-items: center;     /* 垂直居中对齐按钮 */
            margin-top: 10px;
          }

          .pagination-btn {
            margin: 0 5px;
            padding: 5px 10px;
            border: 1px solid #ddd;
            background-color: #f8f8f8;
            cursor: pointer;
          }

          .pagination-btn:hover {
            background-color: #e0e0e0;
          }

          .pagination-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
          }

          .pagination-btn:focus {
            outline: none;
          }

          #page-info {
            margin: 0 10px;
          }
        </style>

    </head>


    <body class="fixed-left">

        <!-- Loader -->
        <div id="preloader">
            <div id="status">
                <div class="spinner">
                    <div class="rect1"></div>
                    <div class="rect2"></div>
                    <div class="rect3"></div>
                    <div class="rect4"></div>
                    <div class="rect5"></div>
                </div>
            </div>
        </div>

        <!-- Begin page -->
        <div id="wrapper">

            <!-- ========== Left Sidebar Start ========== -->
            <div class="left side-menu">
                <button type="button" class="button-menu-mobile button-menu-mobile-topbar open-left waves-effect">
                    <i class="mdi mdi-close"></i>
                </button>

                <div class="left-side-logo d-block d-lg-none">
                    <div class="text-center">

                        <a href="{% url 'index' %}" class="logo"><img src="{% static 'shows/vertical/assets/images/logo_dark.png' %}" height="20" alt="logo"></a>
                    </div>
                </div>

                <div class="sidebar-inner slimscrollleft">
                <div id="sidebar-menu">
                    <ul>
                        <li class="menu-title">Main</li>

                        <li>
                            <a href="{% url 'index' %}" class="waves-effect">
                                <i class="dripicons-home"></i>
                                <span> 首页 <span class="badge badge-success badge-pill float-right"></span></span>
                            </a>
                        </li>
                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="dripicons-briefcase"></i> <span> 导航 </span> <span class="menu-arrow float-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li style="background: linear-gradient(45deg,#ddba62, rgba(239,239,236,0.87), #dab75f);">
                                    <a href="{% url "shows:ui_alerts" %}"><strong>智能问答</strong></a>
                                </li>
                                <li><a href="{% url "shows:ui_badge" %}">热门评论</a></li>
                                <li><a href="{% url "shows:form_editors" %}">发布测评</a></li>
                                <li><a href="{% url "shows:ui_cards" %}">畅销空调</a></li>
                                <li><a href="{% url "shows:ui_popover_tooltips" %}">综合测评</a></li>
                                <li style="background: linear-gradient(45deg,#ddba62, rgba(239,239,236,0.87), #dab75f);">
                                    <a href="{% url "shows:ui_grid" %}"><strong>智能对比</strong></a>
                                </li>
                            </ul>
                        </li>
                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="dripicons-calendar"></i><span> 词云库 </span><span class="menu-arrow float-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li style="background: linear-gradient(45deg,#ddba62, rgba(239,239,236,0.87), #dab75f);">
                                    <a href="{% url "shows:calendar" %}"><strong>热点词云</strong></a>
                                </li>
                            </ul>
                        </li>

                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="dripicons-graph-bar"></i><span> echarts图 </span> <span class="menu-arrow float-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li><a href="{% url "shows:charts_morris" %}">时间销量</a></li>
                                <li style="background: linear-gradient(45deg,#ddba62, rgba(239,239,236,0.87), #dab75f);">
                                    <a href="{% url "shows:charts_c3" %}"><strong>品牌销量</strong></a>
                                </li>
                            </ul>
                        </li>
                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="dripicons-view-thumb"></i><span> 表格 </span> <span class="menu-arrow float-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li><a href="{% url "shows:tables_responsive" %}">商品信息</a></li>
                                <li><a href="{% url "shows:tables_datatable" %}">商品评论</a></li>
                            </ul>
                        </li>
                        <li class="menu-title">扩展</li>
                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="dripicons-location"></i><span> 地图 </span> <span class="badge badge-danger badge-pill float-right"></span></a>
                            <ul class="list-unstyled">
                                <li><a href="{% url "shows:maps_google" %}"> 热力图 </a></li>
                            </ul>
                        </li>
                        <li class="has_sub">
                            <a href="javascript:void(0);" class="waves-effect"><i class="dripicons-medical"></i><span> 扩展 </span> <span class="menu-arrow float-right"><i class="mdi mdi-chevron-right"></i></span></a>
                            <ul class="list-unstyled">
                                <li><a href="{% url "shows:extras_pricing" %}">支持一下</a></li>
                                <li><a href="{% url "shows:extras_faqs" %}">常见问题</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
            <div class="clearfix"></div>
        </div> <!-- end sidebarinner -->
    </div>

            <!-- Start right Content here -->

            <div class="content-page">
                <!-- Start content -->
                <div class="content">

                    <!-- Top Bar Start -->
                    <div class="topbar">

                        <div class="topbar-left	d-none d-lg-block">
                            <div class="text-center">
                                <a href="{% url "index" %}" class="logo"><img src="{% static 'shows/vertical/assets/images/logo.png' %}" height="30" alt="logo"></a>
                            </div>
                        </div>

                        <nav class="navbar-custom">

                             <!-- Search input -->
                             <div class="search-wrap" id="search-wrap">
                                <div class="search-bar">
                                    <input class="search-input" type="search" placeholder="Search" />
                                    <a href="#" class="close-search toggle-search" data-target="#search-wrap">
                                        <i class="mdi mdi-close-circle"></i>
                                    </a>
                                </div>
                            </div>

                            <ul class="list-inline float-right mb-0">
                                <li class="list-inline-item dropdown notification-list">
                                    <a class="nav-link waves-effect toggle-search" href="#"  data-target="#search-wrap">
                                        <i class="mdi mdi-magnify noti-icon"></i>
                                    </a>
                                </li>

                                <li class="list-inline-item dropdown notification-list">
                                    <a class="nav-link dropdown-toggle arrow-none waves-effect" data-toggle="dropdown" href="#" role="button"
                                    aria-haspopup="false" aria-expanded="false">
                                        <i class="mdi mdi-bell-outline noti-icon"></i>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right dropdown-arrow dropdown-menu-lg dropdown-menu-animated">
                                        <!-- item-->
                                        <div class="dropdown-item noti-title">
                                            <h5>Notification (3)</h5>
                                        </div>

                                        <div class="slimscroll-noti">
                                            <!-- item-->
                                            <a href="javascript:void(0);" class="dropdown-item notify-item active">
                                                <div class="notify-icon bg-success"><i class="mdi mdi-cart-outline"></i></div>
                                                <p class="notify-details"><b>Your order is placed</b><span class="text-muted">Dummy text of the printing and typesetting industry.</span></p>
                                            </a>

                                            <!-- item-->
                                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                                <div class="notify-icon bg-danger"><i class="mdi mdi-message-text-outline"></i></div>
                                                <p class="notify-details"><b>New Message received</b><span class="text-muted">You have 87 unread messages</span></p>
                                            </a>

                                            <!-- item-->
                                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                                <div class="notify-icon bg-info"><i class="mdi mdi-filter-outline"></i></div>
                                                <p class="notify-details"><b>Your item is shipped</b><span class="text-muted">It is a long established fact that a reader will</span></p>
                                            </a>

                                            <!-- item-->
                                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                                <div class="notify-icon bg-success"><i class="mdi mdi-message-text-outline"></i></div>
                                                <p class="notify-details"><b>New Message received</b><span class="text-muted">You have 87 unread messages</span></p>
                                            </a>

                                            <!-- item-->
                                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                                <div class="notify-icon bg-warning"><i class="mdi mdi-cart-outline"></i></div>
                                                <p class="notify-details"><b>Your order is placed</b><span class="text-muted">Dummy text of the printing and typesetting industry.</span></p>
                                            </a>

                                        </div>


                                        <!-- All-->
                                        <a href="javascript:void(0);" class="dropdown-item notify-all">
                                            View All
                                        </a>

                                    </div>
                                </li>


                                <li class="list-inline-item dropdown notification-list nav-user">
                                    <a class="nav-link dropdown-toggle arrow-none waves-effect" data-toggle="dropdown" href="#" role="button"
                                    aria-haspopup="false" aria-expanded="false">
                                        <img src="{% static 'shows/vertical/assets/images/users/avatar-' %}{{ role_ID }}.jpg" alt="user" class="rounded-circle">
                                        <span class="d-none d-md-inline-block ml-1">{{ nickname }} <i class="mdi mdi-chevron-down"></i> </span>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated profile-dropdown">
                                        <a class="dropdown-item" href="{% url 'index:profile' %}"><i class="dripicons-user text-muted"></i> Profile</a>
                                        <a class="dropdown-item" href="{% url 'index:wallet' %}"><i class="dripicons-wallet text-muted"></i> My Wallet</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="{% url 'logout' %}"><i class="dripicons-exit text-muted"></i> Logout</a>
                                    </div>
                                </li>

                            </ul>

                            <ul class="list-inline menu-left mb-0">
                                <li class="list-inline-item">
                                    <button type="button" class="button-menu-mobile open-left waves-effect">
                                        <i class="mdi mdi-menu"></i>
                                    </button>
                                </li>
                                <li class="list-inline-item dropdown notification-list d-none d-sm-inline-block">
                                    <a class="nav-link dropdown-toggle arrow-none waves-effect" data-toggle="dropdown" href="#" role="button"
                                    aria-haspopup="false" aria-expanded="false">
                                        Create New <i class="mdi mdi-plus"></i>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-animated">
                                        <a class="dropdown-item" href="#">Action</a>
                                        <a class="dropdown-item" href="#">Another action</a>
                                        <a class="dropdown-item" href="#">Something else here</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="#">Separated link</a>
                                    </div>
                                </li>
                                <li class="list-inline-item notification-list d-none d-sm-inline-block">
                                    <a href="#" class="nav-link waves-effect">
                                        Activity
                                    </a>
                                </li>

                            </ul>

                        </nav>

                    </div>
                    <!-- Top Bar End -->

                    <div class="page-content-wrapper ">

                        <div class="container-fluid">

                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="page-title-box">
                                        <div class="row align-items-center">
                                            <div class="col-md-8">
                                                <h4 class="page-title m-0">空调商品信息表</h4>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="float-right d-none d-md-block">
                                                    <div class="dropdown">
                                                        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                            <i class="ti-settings mr-1"></i> Settings
                                                        </button>
                                                        <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated">
                                                            <a class="dropdown-item" href="#">Action</a>
                                                            <a class="dropdown-item" href="#">Another action</a>
                                                            <a class="dropdown-item" href="#">Something else here</a>
                                                            <div class="dropdown-divider"></div>
                                                            <a class="dropdown-item" href="#">Separated link</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- end col -->
                                        </div>
                                        <!-- end row -->
                                    </div>
                                    <!-- end page-title-box -->
                                </div>
                            </div> 
                            <!-- end page title -->

                            <div class="row">
                                <div class="col-12">
                                    <div class="card m-b-30">
                                        <div class="card-body">
            
                                            <h4 class="mt-0 header-title" style="font-size: 20px;">商品信息预览表</h4>
                                            <p class="text-muted m-b-30 font-14">展示了商品的基础信息，包括商品的ID、名称，店铺的名称价格等信息</p>
            
                                            <div class="table-rep-plugin">
                                                <div class="table-responsive b-0 table-container" data-pattern="priority-columns">
                                                  <table id="tech-companies-1" class="table  table-striped">
                                                    <thead class="table-header">
                                                      <tr>
                                                        <th data-priority="1">商品ID</th>
                                                        <th data-priority="3">商品名称</th>
                                                        <th data-priority="1">店铺</th>
                                                        <th data-priority="3">价格</th>
                                                        <th data-priority="3">商品图片链接</th>
                                                        <th data-priority="6">店铺链接</th>
                                                        <th data-priority="6">评论数</th>
                                                        <th data-priority="6">商品详情链接地址</th>
                                                      </tr>
                                                    </thead>
                                                    <tbody class="table-content">
                                                    </tbody>
                                                  </table>
                                                </div>
                                              </div>
                                            <div id="pagination" class="pagination">
                                            <button id="prev-page" class="pagination-btn">上一页</button>
                                            <span id="page-info"></span>
                                            <button id="next-page" class="pagination-btn">下一页</button>
                                            </div>
                                        </div>
                                    </div>
                                </div> <!-- end col -->
                            </div> <!-- end row -->            

                        </div><!-- container fluid -->

                    </div> <!-- Page content Wrapper -->

                </div> <!-- content -->

                <footer class="footer">
                    © 2024 MDLAC <span class="d-none d-md-inline-block"> - Crafted with <i class="mdi mdi-heart text-danger"></i> by ThemeMDLAC.</span>
                </footer>

            </div>
            <!-- End Right content here -->

        </div>
        <!-- END wrapper -->


        <!-- jQuery  -->
        <script src="{% static 'shows/vertical/assets/js/jquery.min.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/bootstrap.bundle.min.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/modernizr.min.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/detect.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/fastclick.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/jquery.slimscroll.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/jquery.blockUI.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/waves.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/jquery.nicescroll.js' %}"></script>
        <script src="{% static 'shows/vertical/assets/js/jquery.scrollTo.min.js' %}"></script>

        <!-- Responsive-table-->
{#        <script src="{% static 'shows/plugins/RWD-Table-Patterns/dist/js/rwd-table.min.js' %}"></script>#}

        <!-- App js -->
        <script src="{% static 'shows/vertical/assets/js/app.js' %}"></script>
        
        <script>
          document.addEventListener('DOMContentLoaded', function() {
            const jsonFilePath = 'http://127.0.0.1:8000/shows/get_csv_data/';
            let currentPage = 1;  // 当前页码
            const pageSize = 10;  // 每页数据条数

            function fetchData(page) {
              fetch(`${jsonFilePath}?page=${page}&page_size=${pageSize}`)
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Network response was not ok');
                  }
                  return response.json();  // 解析 JSON 数据
                })
                .then(jsonData => {
                  console.log('JSON Data:', jsonData); // 查看 JSON 数据
                  updateTable(jsonData.data);
                  updatePagination(jsonData);
                })
                .catch(error => console.error('Error fetching data:', error));
            }

            function updateTable(data) {
              console.log('Updating table with data:', data);
              var tbody = document.querySelector('#tech-companies-1 tbody');
              tbody.innerHTML = '';  // 清空现有数据

              data.forEach(function(row) {
                var tr = document.createElement('tr');

                // 按顺序添加表头
                var headers = ['商品ID', '商品名称', '店铺', '价格', '商品图片链接', '商品详情链接地址', '评论数', '店铺链接'];

                headers.forEach(function(header) {
                  var td = document.createElement('td');
                  td.textContent = row[header] || '';  // 防止数据缺失
                  tr.appendChild(td);
                });

                tbody.appendChild(tr);
              });
            }

            function updatePagination(data) {
              console.log('Updating pagination:', data);
              const totalPages = data.total_pages;
              const prevButton = document.getElementById('prev-page');
              const nextButton = document.getElementById('next-page');
              const pageInfo = document.getElementById('page-info');

              pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;

              // 更新按钮状态
              prevButton.disabled = (currentPage === 1);
              nextButton.disabled = (currentPage === totalPages);

              prevButton.onclick = () => {
                if (currentPage > 1) {
                  currentPage--;
                  fetchData(currentPage);
                }
              };

              nextButton.onclick = () => {
                if (currentPage < totalPages) {
                  currentPage++;
                  fetchData(currentPage);
                }
              };
            }

            fetchData(currentPage);  // 初次加载第一页数据
          });
        </script>


    </body>
</html>